import{_ as e,q as t,r as a,e as l,c as s,a as o,d as n,j as r,v as i,y as u,l as d,F as c,f as p,t as h,n as g,i as v,o as k,g as b,h as w}from"./index-LEf4sZUU.js";import{d as f}from"./api-CtTze4QI.js";const m={class:"records-container"},C={class:"search-filters"},y={class:"filter-group"},M={class:"filter-group"},x={class:"records-content"},V={key:0,class:"loading-container"},P={key:1,class:"empty-state"},z={key:2,class:"records-table-wrapper"},S={class:"records-table"},H={class:"code-cell"},j={class:"title-cell"},D={class:"phone-cell"},_={class:"date-cell"},B={class:"date-cell"},L={key:0,class:"pagination"},A=["disabled"],F={class:"page-info"},U=["disabled"],q=e({__name:"BorrowRecords",setup(e){const q=t({phone:"",status:""}),I=a([]),N=a(!1),R=a(""),T=a("success"),Z=t({currentPage:1,pageSize:10,total:0}),$=async(e=1,t=!1)=>{var a,l;t||(N.value=!0);try{const t={phone:q.phone||void 0,status:q.status||void 0,page:e,pageSize:Z.pageSize},a=await f(t);I.value=a.data||a,Z.total=a.total||I.value.length,Z.currentPage=e}catch(s){O("加载记录失败: "+((null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"未知错误"),"error"),console.error("Failed to load records:",s)}finally{N.value=!1}},E=()=>{Z.currentPage=1,$(1)},G=()=>{q.phone="",q.status="",Z.currentPage=1,$(1)},J=e=>{e>=1&&e<=Math.ceil(Z.total/Z.pageSize)&&$(e)},K=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},O=(e,t="success")=>{R.value=e,T.value=t,setTimeout(()=>{R.value=""},3e3)};return l(()=>{$()}),(e,t)=>{const a=v("router-link");return k(),s("div",m,[t[12]||(t[12]=o("div",{class:"page-header"},[o("h1",null,"借阅记录查询"),o("p",{class:"subtitle"},"查询图书的借阅历史和当前状态")],-1)),o("div",C,[o("div",y,[t[4]||(t[4]=o("label",{for:"phone-filter"},"手机号查询",-1)),r(o("input",{type:"tel",id:"phone-filter","onUpdate:modelValue":t[0]||(t[0]=e=>q.phone=e),placeholder:"输入借阅人手机号",maxlength:"11"},null,512),[[i,q.phone]])]),o("div",M,[t[6]||(t[6]=o("label",{for:"status-filter"},"状态筛选",-1)),r(o("select",{id:"status-filter","onUpdate:modelValue":t[1]||(t[1]=e=>q.status=e)},[...t[5]||(t[5]=[o("option",{value:""},"全部状态",-1),o("option",{value:"active"},"借阅中",-1),o("option",{value:"returned"},"已归还",-1)])],512),[[u,q.status]])]),o("div",{class:"action-buttons"},[o("button",{class:"search-button",onClick:E},[...t[7]||(t[7]=[o("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M21 21L16.65 16.65M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),d(" 查询 ",-1)])]),o("button",{class:"reset-button",onClick:G},[...t[8]||(t[8]=[o("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M1 4V7H4M23 20V17H20M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15M20.49 15a9 9 0 0 1-14.85 3.36L1 14M3.51 9a9 9 0 0 0 14.85 3.36M23 10l-4.64-4.36A9 9 0 0 1 3.51 9",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),d(" 重置 ",-1)])])])]),o("div",x,[N.value?(k(),s("div",V,[...t[9]||(t[9]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"加载中...",-1)])])):0===I.value.length?(k(),s("div",P,[...t[10]||(t[10]=[o("div",{class:"empty-icon"},[o("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M9 17H5C3.89543 17 3 16.1046 3 15V4C3 2.89543 3.89543 2 5 2H14C15.1046 2 16 2.89543 16 4V15C16 16.1046 15.1046 17 14 17H10M16 17V19C16 20.1046 15.1046 21 14 21H10C8.89543 21 8 20.1046 8 19V17M9 17V13C9 11.8954 9.89543 11 11 11H13C14.1046 11 15 11.8954 15 13V17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),o("div",{class:"empty-text"},[o("h3",null,"暂无记录"),o("p",null,"没有找到符合条件的借阅记录")],-1)])])):(k(),s("div",z,[o("table",S,[t[11]||(t[11]=o("thead",null,[o("tr",null,[o("th",null,"图书编码"),o("th",null,"图书名称"),o("th",null,"借阅人手机号"),o("th",null,"借阅时间"),o("th",null,"归还时间"),o("th",null,"状态")])],-1)),o("tbody",null,[(k(!0),s(c,null,p(I.value,e=>(k(),s("tr",{key:e.id},[o("td",H,h(e.book.code),1),o("td",j,[b(a,{to:`/book/${e.book.id}`,class:"book-link"},{default:w(()=>[d(h(e.book.title),1)]),_:2},1032,["to"])]),o("td",D,h(e.phone),1),o("td",_,h(K(e.borrowDate)),1),o("td",B,h(e.returnDate?K(e.returnDate):"-"),1),o("td",null,[o("span",{class:g(["status-badge",e.returnDate?"returned":"active"])},h(e.returnDate?"已归还":"借阅中"),3)])]))),128))])]),Z.total>Z.pageSize?(k(),s("div",L,[o("button",{class:"page-button",disabled:1===Z.currentPage,onClick:t[2]||(t[2]=e=>J(Z.currentPage-1))},"上一页",8,A),o("div",F," 第 "+h(Z.currentPage)+" 页，共 "+h(Math.ceil(Z.total/Z.pageSize))+" 页，总计 "+h(Z.total)+" 条 ",1),o("button",{class:"page-button",disabled:Z.currentPage>=Math.ceil(Z.total/Z.pageSize),onClick:t[3]||(t[3]=e=>J(Z.currentPage+1))},"下一页",8,U)])):n("",!0)]))]),R.value?(k(),s("div",{key:0,class:g(["message-toast",T.value])},h(R.value),3)):n("",!0)])}}},[["__scopeId","data-v-89030888"]]);export{q as default};
