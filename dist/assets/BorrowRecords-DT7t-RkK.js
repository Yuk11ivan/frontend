import{_ as z,q as _,r as v,e as B,c as r,a as t,d as C,j as y,v as D,y as S,l as k,F as H,f as L,t as n,n as M,i as N,o as i,g as R,h as j}from"./index-Bw86Jh8l.js";import{d as F}from"./api-DS5VUnfc.js";const T={class:"records-container"},$={class:"search-filters"},A={class:"filter-group"},U={class:"filter-group"},q={class:"records-content"},E={key:0,class:"loading-container"},I={key:1,class:"empty-state"},Z={key:2,class:"records-table-wrapper"},G={class:"records-table"},J={class:"code-cell"},K={class:"title-cell"},O={class:"phone-cell"},Q={class:"date-cell"},W={class:"date-cell"},X={key:0,class:"pagination"},Y=["disabled"],tt={class:"page-info"},et=["disabled"],st={__name:"BorrowRecords",setup(ot){const a=_({phone:"",status:""}),d=v([]),h=v(!1),u=v(""),m=v("success"),s=_({currentPage:1,pageSize:10,total:0}),c=async(l=1,e=!1)=>{var p,o;e||(h.value=!0);try{const g={phone:a.phone||void 0,status:a.status||void 0,page:l,pageSize:s.pageSize},f=await F(g);d.value=f.data||f,s.total=f.total||d.value.length,s.currentPage=l}catch(g){P("加载记录失败: "+(((o=(p=g.response)==null?void 0:p.data)==null?void 0:o.message)||"未知错误"),"error"),console.error("Failed to load records:",g)}finally{h.value=!1}},x=()=>{s.currentPage=1,c(1)},V=()=>{a.phone="",a.status="",s.currentPage=1,c(1)},w=l=>{l>=1&&l<=Math.ceil(s.total/s.pageSize)&&c(l)},b=l=>l?new Date(l).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"",P=(l,e="success")=>{u.value=l,m.value=e,setTimeout(()=>{u.value=""},3e3)};return B(()=>{c()}),(l,e)=>{const p=N("router-link");return i(),r("div",T,[e[12]||(e[12]=t("div",{class:"page-header"},[t("h1",null,"借阅记录查询"),t("p",{class:"subtitle"},"查询图书的借阅历史和当前状态")],-1)),t("div",$,[t("div",A,[e[4]||(e[4]=t("label",{for:"phone-filter"},"手机号查询",-1)),y(t("input",{type:"tel",id:"phone-filter","onUpdate:modelValue":e[0]||(e[0]=o=>a.phone=o),placeholder:"输入借阅人手机号",maxlength:"11"},null,512),[[D,a.phone]])]),t("div",U,[e[6]||(e[6]=t("label",{for:"status-filter"},"状态筛选",-1)),y(t("select",{id:"status-filter","onUpdate:modelValue":e[1]||(e[1]=o=>a.status=o)},[...e[5]||(e[5]=[t("option",{value:""},"全部状态",-1),t("option",{value:"active"},"借阅中",-1),t("option",{value:"returned"},"已归还",-1)])],512),[[S,a.status]])]),t("div",{class:"action-buttons"},[t("button",{class:"search-button",onClick:x},[...e[7]||(e[7]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M21 21L16.65 16.65M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),k(" 查询 ",-1)])]),t("button",{class:"reset-button",onClick:V},[...e[8]||(e[8]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M1 4V7H4M23 20V17H20M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15M20.49 15a9 9 0 0 1-14.85 3.36L1 14M3.51 9a9 9 0 0 0 14.85 3.36M23 10l-4.64-4.36A9 9 0 0 1 3.51 9",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),k(" 重置 ",-1)])])])]),t("div",q,[h.value?(i(),r("div",E,[...e[9]||(e[9]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"加载中...",-1)])])):d.value.length===0?(i(),r("div",I,[...e[10]||(e[10]=[t("div",{class:"empty-icon"},[t("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M9 17H5C3.89543 17 3 16.1046 3 15V4C3 2.89543 3.89543 2 5 2H14C15.1046 2 16 2.89543 16 4V15C16 16.1046 15.1046 17 14 17H10M16 17V19C16 20.1046 15.1046 21 14 21H10C8.89543 21 8 20.1046 8 19V17M9 17V13C9 11.8954 9.89543 11 11 11H13C14.1046 11 15 11.8954 15 13V17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),t("div",{class:"empty-text"},[t("h3",null,"暂无记录"),t("p",null,"没有找到符合条件的借阅记录")],-1)])])):(i(),r("div",Z,[t("table",G,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",null,"图书编码"),t("th",null,"图书名称"),t("th",null,"借阅人手机号"),t("th",null,"借阅时间"),t("th",null,"归还时间"),t("th",null,"状态")])],-1)),t("tbody",null,[(i(!0),r(H,null,L(d.value,o=>(i(),r("tr",{key:o.id},[t("td",J,n(o.book.code),1),t("td",K,[R(p,{to:`/book/${o.book.id}`,class:"book-link"},{default:j(()=>[k(n(o.book.title),1)]),_:2},1032,["to"])]),t("td",O,n(o.phone),1),t("td",Q,n(b(o.borrowDate)),1),t("td",W,n(o.returnDate?b(o.returnDate):"-"),1),t("td",null,[t("span",{class:M(["status-badge",o.returnDate?"returned":"active"])},n(o.returnDate?"已归还":"借阅中"),3)])]))),128))])]),s.total>s.pageSize?(i(),r("div",X,[t("button",{class:"page-button",disabled:s.currentPage===1,onClick:e[2]||(e[2]=o=>w(s.currentPage-1))},"上一页",8,Y),t("div",tt," 第 "+n(s.currentPage)+" 页，共 "+n(Math.ceil(s.total/s.pageSize))+" 页，总计 "+n(s.total)+" 条 ",1),t("button",{class:"page-button",disabled:s.currentPage>=Math.ceil(s.total/s.pageSize),onClick:e[3]||(e[3]=o=>w(s.currentPage+1))},"下一页",8,et)])):C("",!0)]))]),u.value?(i(),r("div",{key:0,class:M(["message-toast",m.value])},n(u.value),3)):C("",!0)])}}},at=z(st,[["__scopeId","data-v-89030888"]]);export{at as default};
